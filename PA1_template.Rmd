# Reproducible Research: Peer Assessment 1

```{r}
## numbers >= 10^5 will be denoted in scientific notation,
## and rounded to 2 digits
options(scipen = 1, digits = 2)
```


## Loading and preprocessing the data
```{r}
unzip("activity.zip")
activity <- read.csv("activity.csv")
activity$date <- as.Date(activity$date)
```



## What is mean total number of steps taken per day?
The distribution of the total number of steps per day can be seen in the following histogram.

```{r}
sum.per.day <- sapply(split(activity$steps,f=activity$date),sum)
hist(sum.per.day)
mean.sum.per.day <-  mean(sum.per.day,na.rm=T)
median.sum.per.day <-  median(sum.per.day,na.rm=T)

```


The __mean__ total number of steps per day is `r mean.sum.per.day` and the __median__ total number of steps per day is `r median.sum.per.day`



## What is the average daily activity pattern?
```{r}
mean.per.interval <- sapply(split(activity$steps,activity$interval),mean,na.rm=T)
plot(mean.per.interval,type="l",xaxt="n",xlab="interval",ylab="average steps")
labels <- seq(from=1,to=288,length.out=5)
axis(1,labels=names(mean.per.interval)[labels],at=labels)
```

```{r}
max.index <- which.max(mean.per.interval)[[1]]
```

The maximum number of steps (on average) is in the intervall `r names(mean.per.interval)[max.index]`.
This interval has `r mean.per.interval[max.index][[1]]` steps on average.


## Imputing missing values
The activity data set contains ´r nrow(activity[is.na(activity$steps),])´ rows where data fro teh number of steps is missing.

We will replace those NAs with the average number of steps for its interval.
```{r}
steps.imputted <- apply(X=activity[is.na(activity),],MARGIN=1,FUN=function(x) {

  interval <- as.character(as.integer(x[3]))
  mean.per.interval[interval]
})
activity.imputted <- data.frame(activity)
activity.imputted[is.na(activity),]$steps <- steps.imputted
```

```{r}

sum.per.day.imputted <- sapply(split(activity.imputted$steps,f=activity$date),sum)
hist(sum.per.day.imputted)
mean.sum.per.day.imputted <-  mean(sum.per.day.imputted)
median.sum.per.day.imputted <-  median(sum.per.day.imputted)

```


The __imputted mean__ total number of steps per day is `r mean.sum.per.day.imputted` and the __imputted median__ total number of steps per day is `r median.sum.per.day.imputted`




## Are there differences in activity patterns between weekdays and weekends?
